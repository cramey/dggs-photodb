<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Photo Database</title>
		<style>
			#results { text-align: center; }
			#results img { margin: 4px 8px; vertical-align: text-top; }
			#page-prev, #page-next { margin: 4px 8px; }
			#page-prev { float: left; }
			#page-next { float: right; }
		</style>
		<script src="js/jquery-2.1.3.min.js"></script>
		<script>
			var last = [0,0];

			$(function(){
				$('#btn-search').click(function(){
					last = [0,0];
					search(false);
				}).click();

				$('#emptydesc').change(function(){
					$('#btn-search').click();
				});

				$('#page-prev').click(function(){ search(true); });
				$('#page-next').click(function(){ search(false); });
			});

			function search(back)
			{
				$.ajax({
					url: 'list.json', dataType: 'json',
					data: {
						'id': back ? last[0] : last[1],
						'show': $('#show').val(),
						'emptydesc': $('#emptydesc').val(),
						'back': back
					},
					success: function(json){
						if(json.length){
							var results = $('#results').empty().get(0);

							var render = function(im){
								var img = document.createElement('img');
								img.src = 'thumbnail/' + im['ID'];
								results.appendChild(img);
							};

							if(back){
								for(var i=json.length; i--;) render(json[i]);

								last[0] = json[json.length - 1]['ID'];
								last[1] = json[0]['ID'];
							} else {
								for(var i=0; i < json.length; i++) render(json[i]);

								last[0] = json[0]['ID'];
								last[1] = json[json.length - 1]['ID'];
							}

							$('#resultscontainer').show();
						}
					}
				});
			}
		</script>
	</head>
	<body load="init()">
		<fieldset>
			<legend>Search</legend>
			<button id="page-prev">Previous Page</button>
			<button id="page-next">Next Page</button>

			<label for="emptydesc">Description: </label>
			<select name="emptydesc" id="emptydesc">
				<option value="">Any</option>
				<option value="true" selected="selected">Only Empty</option>
				<option value="false">Only Filled</option>
			</select>

			<label for="show">Showing: </label>
			<input type="text" size="4" name="show" id="show" value="6" />

			<button id="btn-search">Search</button>
		</fieldset>

		<fieldset id="resultscontainer">
			<legend>Results</legend>
			<div id="results"></div>
		</fieldset>
	</body>
</html>
